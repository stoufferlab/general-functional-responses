(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15333,        450]
NotebookOptionsPosition[     14407,        427]
NotebookOutlinePosition[     14747,        442]
CellTagsIndexPosition[     14704,        439]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AA", "[", 
     RowBox[{"a_", ",", "h_", ",", "m_"}], "]"}], ":=", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", "\[CapitalNu]"}], 
      RowBox[{
       SuperscriptBox["P", "m"], "+", 
       RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}]], " ", "P", " ", 
     "T"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.792509750504669*^9, 3.7925097511373568`*^9}, {
  3.79250980804393*^9, 3.792509859515792*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"092c2aca-aa91-4cc6-a5ca-7212ce2cd09a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hessian", "[", 
   RowBox[{"fun_", ",", "pars_"}], "]"}], ":=", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"fun", ",", "pars"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"pars", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.792508985533945*^9, 3.792509013065542*^9}, {
  3.792509109926668*^9, 3.792509110396137*^9}, {3.792509158064125*^9, 
  3.792509182346109*^9}, {3.792509242780163*^9, 3.7925092863634872`*^9}, {
  3.792509569014029*^9, 3.79250957238813*^9}, {3.792509672105785*^9, 
  3.7925097026000013`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"5dbd38c2-6ff0-4141-b2c1-4df86fce82cf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "-", "y"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"x", "^", "2"}], "+", 
      RowBox[{"y", "^", "2"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hessian", "[", 
   RowBox[{"f", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "//", "MatrixForm"}]}], "Input",\

 CellChangeTimes->{{3.792509193867148*^9, 3.792509199876452*^9}, {
  3.792509247092319*^9, 3.792509292443759*^9}, {3.7925095834386673`*^9, 
  3.79250958353262*^9}, {3.792509640721027*^9, 3.79250964085415*^9}, {
  3.792509674057843*^9, 3.792509677744033*^9}, {3.792509717251008*^9, 
  3.792509728504653*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"c25b8c82-1bfd-4926-b9af-f65d268a9352"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"8", " ", 
         SuperscriptBox["x", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "-", "y"}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "3"]], "-", 
       FractionBox[
        RowBox[{"8", " ", 
         SuperscriptBox["x", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "2"]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "-", "y"}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "2"]], "+", 
       FractionBox["2", 
        RowBox[{"1", "+", 
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"8", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "-", "y"}], ")"}], " ", "y"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "3"]], "+", 
       FractionBox[
        RowBox[{"2", " ", "x"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "2"]], "-", 
       FractionBox[
        RowBox[{"4", " ", "x", " ", "y"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"8", " ", "x", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "-", "y"}], ")"}], " ", "y"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "3"]], "+", 
       FractionBox[
        RowBox[{"2", " ", "x"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "2"]], "-", 
       FractionBox[
        RowBox[{"4", " ", "x", " ", "y"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "-", "y"}], ")"}], " ", 
         SuperscriptBox["y", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "3"]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "-", "y"}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "2"]], "+", 
       FractionBox[
        RowBox[{"4", " ", "y"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}], "2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.792509200323955*^9, 3.792509263639902*^9}, 
   3.792509297283765*^9, {3.7925095771050262`*^9, 3.792509592132271*^9}, {
   3.792509628328176*^9, 3.7925096413458767`*^9}, {3.792509704918407*^9, 
   3.792509728782501*^9}},
 CellLabel->
  "Out[86]//MatrixForm=",ExpressionUUID->"256c795e-dfe7-415e-a51a-\
9b30ee62a246"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.792509868763007*^9, 
  3.792509869084977*^9}},ExpressionUUID->"7130b502-c2c6-4280-bdd2-\
3d631f1e8cb7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"hessian", "[", 
   RowBox[{"lLAA", ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", " ", "h", ",", " ", "m"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.792509871149688*^9, 
  3.7925099031103783`*^9}},ExpressionUUID->"eae949b5-8b60-4fce-8e13-\
9f4ab2339ad5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "a", " ", 
         SuperscriptBox["h", "2"], " ", "P", " ", "T", " ", 
         SuperscriptBox["\[CapitalNu]", "3"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]], "-", 
       
       FractionBox[
        RowBox[{"2", " ", "h", " ", "P", " ", "T", " ", 
         SuperscriptBox["\[CapitalNu]", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", "h", " ", "P", " ", "T", " ", 
         SuperscriptBox["\[CapitalNu]", "3"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]], "-", 
       
       FractionBox[
        RowBox[{"2", " ", "a", " ", "P", " ", "T", " ", 
         SuperscriptBox["\[CapitalNu]", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "a", " ", "h", " ", 
         SuperscriptBox["P", 
          RowBox[{"1", "+", "m"}]], " ", "T", " ", 
         SuperscriptBox["\[CapitalNu]", "2"], " ", 
         RowBox[{"Log", "[", "P", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]], "-", 
       
       FractionBox[
        RowBox[{
         SuperscriptBox["P", 
          RowBox[{"1", "+", "m"}]], " ", "T", " ", "\[CapitalNu]", " ", 
         RowBox[{"Log", "[", "P", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", "h", " ", "P", " ", "T", " ", 
         SuperscriptBox["\[CapitalNu]", "3"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]], "-", 
       
       FractionBox[
        RowBox[{"2", " ", "a", " ", "P", " ", "T", " ", 
         SuperscriptBox["\[CapitalNu]", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "2"]]}], 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["a", "3"], " ", "P", " ", "T", " ", 
        SuperscriptBox["\[CapitalNu]", "3"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["P", "m"], "+", 
          RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]], 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["P", 
         RowBox[{"1", "+", "m"}]], " ", "T", " ", 
        SuperscriptBox["\[CapitalNu]", "2"], " ", 
        RowBox[{"Log", "[", "P", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["P", "m"], "+", 
          RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "a", " ", "h", " ", 
         SuperscriptBox["P", 
          RowBox[{"1", "+", "m"}]], " ", "T", " ", 
         SuperscriptBox["\[CapitalNu]", "2"], " ", 
         RowBox[{"Log", "[", "P", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]], "-", 
       
       FractionBox[
        RowBox[{
         SuperscriptBox["P", 
          RowBox[{"1", "+", "m"}]], " ", "T", " ", "\[CapitalNu]", " ", 
         RowBox[{"Log", "[", "P", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "2"]]}], 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["P", 
         RowBox[{"1", "+", "m"}]], " ", "T", " ", 
        SuperscriptBox["\[CapitalNu]", "2"], " ", 
        RowBox[{"Log", "[", "P", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["P", "m"], "+", 
          RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]], 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "a", " ", 
         SuperscriptBox["P", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "m"}]}]], " ", "T", " ", "\[CapitalNu]", " ", 
         SuperscriptBox[
          RowBox[{"Log", "[", "P", "]"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "3"]], "-", 
       
       FractionBox[
        RowBox[{"a", " ", 
         SuperscriptBox["P", 
          RowBox[{"1", "+", "m"}]], " ", "T", " ", "\[CapitalNu]", " ", 
         SuperscriptBox[
          RowBox[{"Log", "[", "P", "]"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["P", "m"], "+", 
           RowBox[{"a", " ", "h", " ", "\[CapitalNu]"}]}], ")"}], "2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.792509885548748*^9, 3.792509890732299*^9}},
 CellLabel->
  "Out[89]//MatrixForm=",ExpressionUUID->"42014754-5c89-4e37-95f3-\
ea85428e24ae"]
}, Open  ]]
},
WindowSize->{1242, 1203},
WindowMargins->{{Automatic, 642}, {Automatic, 85}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 676, 17, 188, "Input",ExpressionUUID->"092c2aca-aa91-4cc6-a5ca-7212ce2cd09a"],
Cell[1237, 39, 676, 15, 37, "Input",ExpressionUUID->"5dbd38c2-6ff0-4141-b2c1-4df86fce82cf"],
Cell[CellGroupData[{
Cell[1938, 58, 904, 25, 64, "Input",ExpressionUUID->"c25b8c82-1bfd-4926-b9af-f65d268a9352"],
Cell[2845, 85, 4506, 135, 137, "Output",ExpressionUUID->"256c795e-dfe7-415e-a51a-9b30ee62a246"]
}, Open  ]],
Cell[7366, 223, 232, 5, 116, "Input",ExpressionUUID->"7130b502-c2c6-4280-bdd2-3d631f1e8cb7"],
Cell[CellGroupData[{
Cell[7623, 232, 322, 9, 37, "Input",ExpressionUUID->"eae949b5-8b60-4fce-8e13-9f4ab2339ad5"],
Cell[7948, 243, 6443, 181, 165, "Output",ExpressionUUID->"42014754-5c89-4e37-95f3-ea85428e24ae"]
}, Open  ]]
}
]
*)

